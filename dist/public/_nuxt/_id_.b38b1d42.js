import G from"./ArgonButton.a79d4a57.js";import W from"./ArgonInput.8d0576a6.js";import X from"./ArgonRadio.e49aefcd.js";import Z from"./ArgonSwitch.8ac71057.js";import{y as ee,J as te,P as se,a4 as oe,Q as y,K as E,R as L,S as ae,o as u,b as p,e as o,T as $,u as e,c as ne,w as g,i as C,l as r,t as f,a7 as O,a8 as R,F as B,k as D,h as v,U as M}from"./entry.6e39450e.js";import{C as N}from"./choices.553387e5.js";import{u as le}from"./ItemStore.9ee858b8.js";import{u as ie}from"./TagStore.0779537d.js";import{u as re}from"./CategoryStore.cfacd2c0.js";import{u as me,c as de,r as ue}from"./index.c39e5092.js";import{Q as ce}from"./vue-quill.esm-bundler.bc216698.js";import{i as k,g as A,c as pe}from"./errorHandler.790c67ca.js";import{d as h}from"./default_avatar.3b6e3719.js";import"./index.aad0ddd6.js";import"./tslib.es6.4057be70.js";const ge={class:"card shadow-lg mx-4 p-3 mt-4"},_e={class:"d-flex justify-content-between px-4 pt-3"},fe=o("h5",{class:"font-weight-bolder mb-0"},"Edit Item",-1),he=o("span",{class:"btn-inner--text"},"Back to list",-1),ve=[he],be={class:"mt-4"},ye={class:"d-flex flex-column max-content align-items-center mb-4 mx-4"},xe=["src"],Ie={class:"mt-2 d-flex justify-content-center"},we=o("span",null,[o("i",{class:"fa fa-times"}),v(" Remove ")],-1),Ve={for:"imageInput",class:"mb-0"},Se={class:"col-12 mt-sm-0"},$e=o("label",null,"Name",-1),Ce={class:"col-12 mt-sm-0"},ke=o("label",null,"Description",-1),Ae={key:0,style:{color:"#fd5c70","margin-left":"5px","font-size":"12px"}},Te={class:"col-12 mt-3"},Ue=o("label",null,"Category",-1),Ee=["value"],Le={class:"col-12 mt-3"},Oe=o("label",null,"Tags",-1),Re=["value"],Be={key:0,style:{color:"#fd5c70","margin-left":"5px","font-size":"12px"}},De={class:"col-12 mt-3"},Me=o("label",null,"Status",-1),Ne={class:"col-12 mt-3"},He=o("label",null,"Show on homepage?",-1),Fe={class:"col-2 mt-3"},qe=o("label",null,"Date",-1),je={class:"button-row d-flex mt-4"},lt={__name:"[id]",async setup(Je){let m,d;ee(()=>{H("choices-category"),F("choices-tags")});const H=l=>{const t=document.getElementById(l);if(t)return new N(t,{searchEnabled:!1})},F=l=>{const t=document.getElementById(l);if(t)return new N(t,{removeItemButton:!0})},{$isDemo:q,$demoMessage:j}=te(),T=se(),{params:{id:b}}=oe(),i=le(),x=ie(),I=re();[m,d]=y(()=>i.getItem(b)),await m,d(),i.allItemsList||([m,d]=y(()=>i.getAllItemsList()),await m,d()),x.allTagsList||([m,d]=y(()=>x.getAllTagsList()),await m,d()),I.allCategoriesList||([m,d]=y(()=>I.getAllCategoriesList()),await m,d());const c=E(i.selectedItem.image),w=E(null),s=L({name:i.selectedItem.name,description:i.selectedItem.description,category:i.selectedItem.category.id,tags:i.selectedItem.tags.map(l=>l.id),status:i.selectedItem.status,isOnHomepage:i.selectedItem.is_on_homepage,date:i.selectedItem.date_at}),n=L([]),J=async()=>{const l=w.value.files;if(!l.length)return;const t=new FileReader;t.readAsDataURL(l[0]),t.onload=()=>{c.value=t.result}},Q=()=>{c.value=h},z=ae(()=>({name:{required:de.withMessage("The name field is required",ue)}})),V=me(z,s),P=async()=>{if(n.value=[],V.value.$validate(),K(),V.value.$error||n.value.length){const l=JSON.parse(JSON.stringify(V.value.$errors));n.value=[...n.value,...l]}else try{let l="";c.value!==h&&(l=await i.uploadItemImage(w,b));const t=await i.updateItem({itemId:b,name:s.name,description:s.description,status:s.status,image:l,date:s.date,isOnHomepage:s.isOnHomepage,category:s.category,tags:s.tags});if(t.error.value){const _=t.error.value.data.errors[0].detail;throw new Error(_)}else M("success","Item updated successfuly"),T.push({path:"/examples/item-management/list-items"})}catch(l){M("error",l.message)}},K=()=>{pe(s.name,i.allItemsList,i.selectedItem.name)&&(n.value=[...n.value,{$property:"name",$message:"The Item with this name already exists."}]),s.description==="<p><br></p>"&&(n.value=[...n.value,{$property:"description",$message:"The description field is required"}]),s.tags.length||(n.value=[...n.value,{$property:"tags",$message:"You should choose at least one tag."}])};return(l,t)=>{const _=G,U=W,S=X,Y=Z;return u(),p("div",ge,[o("div",_e,[fe,o("button",{onClick:t[0]||(t[0]=$(a=>e(T).push({path:"/examples/item-management/list-items"}),["prevent"])),type:"button",class:"btn base-button btn-icon btn-fab btn-primary btn-sm"},ve)]),o("div",be,[o("form",{role:"form",onSubmit:t[12]||(t[12]=$(a=>e(q)(e(b))?e(j)("items"):P(),["prevent"]))},[o("div",ye,[o("img",{src:e(c)?e(c):e(h),class:"rounded d-flex justify-content-center argon-image",width:"200",height:"200"},null,8,xe),o("div",Ie,[e(c)!==e(h)?(u(),ne(_,{key:0,type:"button",onClick:t[1]||(t[1]=$(a=>Q(),["prevent"])),class:"btn base-button btn btn-sm btn-danger btn-button mx-2"},{default:g(()=>[we]),_:1})):C("",!0),r(_,{type:"button",class:"btn base-button btn btn-sm btn-primary btn-button"},{default:g(()=>[o("label",Ve,f(e(c)!==e(h)?"Change":"Select image"),1),o("input",{ref_key:"file",ref:w,id:"imageInput",accept:"image/*",type:"file",style:{display:"none"},onChange:t[2]||(t[2]=a=>J())},null,544)]),_:1})])]),o("div",Se,[$e,r(U,{id:"name",name:"name",class:"multisteps-form__input",type:"text",placeholder:"Item Name",modelValue:e(s).name,"onUpdate:modelValue":t[3]||(t[3]=a=>e(s).name=a),error:e(k)("name",e(n)),errorMessage:e(A)("name",e(n))},null,8,["modelValue","error","errorMessage"])]),o("div",Ce,[ke,r(e(ce),{id:"description",name:"description",class:"multisteps-form__input",contentType:"html",content:e(s).description,"onUpdate:content":t[4]||(t[4]=a=>e(s).description=a),style:{"min-height":"150px"}},null,8,["content"]),e(k)("description",e(n))?(u(),p("span",Ae,f(e(A)("description",e(n))),1)):C("",!0)]),o("div",Te,[Ue,O(o("select",{id:"choices-category",class:"form-control",name:"choices-category","onUpdate:modelValue":t[5]||(t[5]=a=>e(s).category=a)},[(u(!0),p(B,null,D(e(I).allCategoriesList,a=>(u(),p("option",{value:a.id},f(a.name),9,Ee))),256))],512),[[R,e(s).category]])]),o("div",Le,[Oe,O(o("select",{id:"choices-tags",class:"form-control",name:"choices-tags",multiple:"","onUpdate:modelValue":t[6]||(t[6]=a=>e(s).tags=a)},[(u(!0),p(B,null,D(e(x).allTagsList,a=>(u(),p("option",{value:a.id},f(a.name),9,Re))),256))],512),[[R,e(s).tags]]),e(k)("tags",e(n))?(u(),p("span",Be,f(e(A)("tags",e(n))),1)):C("",!0)]),o("div",De,[Me,r(S,{id:"published",name:"status",value:"published",modelValue:e(s).status,"onUpdate:modelValue":t[7]||(t[7]=a=>e(s).status=a),checked:""},{default:g(()=>[v("Published ")]),_:1},8,["modelValue"]),r(S,{id:"draft",name:"status",value:"draft",modelValue:e(s).status,"onUpdate:modelValue":t[8]||(t[8]=a=>e(s).status=a)},{default:g(()=>[v("Draft")]),_:1},8,["modelValue"]),r(S,{id:"archive",name:"status",value:"archive",modelValue:e(s).status,"onUpdate:modelValue":t[9]||(t[9]=a=>e(s).status=a)},{default:g(()=>[v("Archive")]),_:1},8,["modelValue"])]),o("div",Ne,[He,r(Y,{id:"isOnHomepage",name:"isOnHomepage",modelValue:e(s).isOnHomepage,"onUpdate:modelValue":t[10]||(t[10]=a=>e(s).isOnHomepage=a),checked:e(s).isOnHomepage},null,8,["modelValue","checked"])]),o("div",Fe,[qe,r(U,{type:"date",placeholder:"Date",modelValue:e(s).date,"onUpdate:modelValue":t[11]||(t[11]=a=>e(s).date=a)},null,8,["modelValue"])]),o("div",je,[r(_,{type:"submit",color:"primary",variant:"gradient",class:"ms-auto mb-0"},{default:g(()=>[v(" Submit ")]),_:1})])],32)])])}}};export{lt as default};
