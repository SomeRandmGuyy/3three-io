import z from"./ArgonInput.8d0576a6.js";import{P as $,K as w,R as A,Q as D,y as R,O as E,o as m,b as p,e,T as I,i as b,l as P,u as r,Y as F,F as U,k as j,t as u,a5 as O,U as C,f as S}from"./entry.6e39450e.js";import{u as Y}from"./index.aad0ddd6.js";import{D as q}from"./datatable.817348b2.js";import{_ as H,h as N}from"./lodash.623e3e94.js";import{u as K}from"./CategoryStore.cfacd2c0.js";import{u as Q}from"./AuthStore.cdc72645.js";import G from"./BasePagination.81d12301.js";import"./tslib.es6.4057be70.js";const J={class:"card shadow-lg mx-4 p-3 mt-4"},W={class:"d-flex justify-content-between px-4 pt-3"},X=e("h5",{class:"font-weight-bolder mb-0"},"Categories List",-1),Z=e("span",{class:"btn-inner--text"},"Add Category",-1),ee=[Z],te={class:"mt-4"},ae={class:"table-responsive"},se={class:"dataTable-search search-block"},oe={id:"category-table",class:"table table-flush"},re={class:"thead-light"},ne=e("th",null,"NAME",-1),le=e("th",null,"DESCRIPTION",-1),ie=e("th",null,"CREATED AT",-1),ce={key:0,"data-sortable":"false"},de={class:"text-sm font-weight-normal"},ue={class:"text-sm font-weight-normal"},ge={class:"text-sm font-weight-normal"},me={key:0,class:"text-sm font-weight-normal"},pe={class:"d-flex align-items-center ms-auto"},fe={class:"cursor-pointer edit"},he={class:"mx-3 cursor-pointer delete"},_e={class:"d-flex justify-content-center justify-content-sm-between flex-wrap"},be={class:"ms-3"},ye=null,ke={__name:"list-categories",async setup(ve){let y,v;const T=$(),l=K(),f=Q();let n;const i=w(""),g=w(""),d=H.debounce(async function(a){await l.getCategoriesList({filter:a.filter?a.filter:"",sort:a.sort?a.sort:"",pageNumber:a.pageNumber,pageSize:a.pageSize}),t.from=l.pageMeta.from,t.to=l.pageMeta.to,t.total=l.pageMeta.total,t.currentPage=l.pageMeta.currentPage,k()},300),t=A({currentPage:1,perPage:5,total:null,from:null,to:null});f.currentUser||([y,v]=D(()=>f.getProfile()),await y,v());const L=async a=>{t.currentPage=a,await d({pageNumber:t.currentPage,pageSize:t.perPage,sort:g.value,filter:i.value})},M=async()=>{document.getElementById("category-table")&&(n=new q("#category-table",{fixedHeight:!0,searchable:!1,perPage:5}),document.querySelector(".dataTable-bottom").remove(),n.setMessage("Loading ..."),await d({pageNumber:t.currentPage,pageSize:t.perPage}),N(x,"/examples/category-management/edit-category/","categories"),n.on("datatable.sort",async function(a,s){n.setMessage("Loading ..."),a=n.labels[a].toLowerCase().replace(" ","_"),s=s=="asc"?"":"-",g.value=s+a,await d({pageNumber:t.currentPage,pageSize:t.perPage,sort:s+a,filter:i.value})}),n.on("datatable.perpage",async function(a){t.perPage=a,await d({pageNumber:1,pageSize:a,sort:g.value,filter:i.value})}))};R(()=>{M()}),E(i,async a=>{tagsListTable.setMessage("Loading ..."),await d({pageNumber:t.currentPage,pageSize:t.perPage,sort:g.value,filter:a})});const h=()=>f.userRole!=="member",x=a=>{O.fire({title:"Delete this category?",showCancelButton:!0,cancelButtonText:"No, keep it",confirmButtonText:"Yes, delete it!",customClass:{confirmButton:"btn bg-gradient-success",cancelButton:"btn bg-gradient-danger"},buttonsStyling:!1}).then(async({isConfirmed:s})=>{if(s)try{const c=await l.deleteCategory(a);if(c.error.value){const o=c.error.value.data.errors[0].detail;C("error",o)}else C("success","Category deleted successfuly"),await d({pageNumber:1,pageSize:t.perPage,sort:g.value,filter:i.value})}catch(c){Y("error",c.message,"$3R2guefVRl")}})},k=()=>{const a=[];l.categoriesList&&l.categoriesList.length>0?(n.data=[],l.categoriesList.forEach(({id:s,name:c,description:o,created_at:_})=>{a.push([`<div class="text-sm font-weight-normal">${c}</div>`,`<div class="text-sm font-weight-normal">${o}</div>`,`<div class="text-sm font-weight-normal">${_}</div>`,`<div class="text-sm font-weight-normal">
                        <div class="d-flex align-items-center ms-auto">
                            <div class="cursor-pointer edit">
                                <i class="fas fa-user-edit text-secondary edit-${s}"></i>
                            </div>
                            <div class="mx-3 cursor-pointer delete">
                                <i class="fas fa-trash text-secondary delete-${s}"></i>
                            </div>
                        </div>
                    </div>`])}),n.refresh(),n.insert({data:a}),N(x,"/examples/category-management/edit-category/","categories")):n.setMessage("No entries found")};return(a,s)=>{const c=z;return m(),p("div",J,[e("div",W,[X,h()?(m(),p("button",{key:0,type:"button",class:"btn base-button btn-icon btn-fab btn-primary btn-sm",onClick:s[0]||(s[0]=I(o=>r(T).push({path:"/examples/category-management/add-category"}),["prevent"]))},ee)):b("",!0)]),e("div",te,[e("div",ae,[e("div",se,[P(c,{modelValue:r(i),"onUpdate:modelValue":s[1]||(s[1]=o=>F(i)?i.value=o:null),class:"dataTable-input search-input-table",placeholder:"Search...",type:"text"},null,8,["modelValue"])]),e("table",oe,[e("thead",re,[e("tr",null,[ne,le,ie,h()?(m(),p("th",ce,"ACTIONS")):b("",!0)])]),e("tbody",null,[(m(),p(U,null,j(ye,({id:o,name:_,description:B,created_at:V})=>e("tr",{key:o},[e("td",de,u(_),1),e("td",ue,u(B),1),e("td",ge,u(V),1),h()?(m(),p("td",me,[e("div",pe,[e("div",fe,[e("i",{class:S(`fas fa-user-edit text-secondary edit-${o}`)},null,2)]),e("div",he,[e("i",{class:S(`fas fa-trash text-secondary delete-${o}`)},null,2)])])])):b("",!0)])),64))])]),e("div",_e,[e("div",be,[e("p",null," Showing "+u(r(t).total?r(t)?.from:0)+" to "+u(r(t)?.to)+" of "+u(r(t).total)+" entries ",1)]),P(G,{modelValue:r(t).currentPage,"onUpdate:modelValue":s[2]||(s[2]=o=>r(t).currentPage=o),class:"pagination-success pagination-md me-3",value:r(t).currentPage,"per-page":r(t).perPage,total:r(t).total,onClick:s[3]||(s[3]=o=>L(o))},null,8,["modelValue","value","per-page","total"])])])])])}}};export{ke as default};
