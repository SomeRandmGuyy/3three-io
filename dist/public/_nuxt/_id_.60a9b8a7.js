import P from"./ArgonButton.a79d4a57.js";import j from"./ArgonInput.8d0576a6.js";import{J as z,P as O,a9 as K,y as Q,Q as S,K as N,R as $,S as G,o as h,b as C,e as t,T as M,u as e,c as H,w as U,i as W,l as d,a7 as X,a8 as Y,F as Z,k as ee,t as k,h as E,U as A}from"./entry.6e39450e.js";import{u as se}from"./UserStore.24d0d5dd.js";import{u as te}from"./RoleStore.d89f21d5.js";import{u as oe,c as u,r as V,e as re,m as ae,s as le}from"./index.c39e5092.js";import{i as b,g as v}from"./errorHandler.790c67ca.js";import{J as ne}from"./index.aad0ddd6.js";import{d as c}from"./default_avatar.3b6e3719.js";import{C as ie}from"./choices.553387e5.js";import"./tslib.es6.4057be70.js";const me={class:"card shadow-lg mx-4 p-3 mt-4"},de={class:"d-flex justify-content-between px-4 pt-3"},ue=t("h5",{class:"font-weight-bolder mb-0"},"Edit User",-1),ce=t("span",{class:"btn-inner--text"},"Back to list",-1),pe=[ce],fe={class:"mt-4"},_e={class:"d-flex flex-column max-content align-items-center mb-4 mx-4"},ge=["src"],we={class:"mt-2 d-flex justify-content-center"},he=t("span",null,[t("i",{class:"fa fa-times"}),E(" Remove ")],-1),be={for:"imageInput",class:"mb-0"},ve={class:"col-12 mt-sm-0"},ye=t("label",null,"Name",-1),xe={class:"col-12 mt-sm-0"},Ce=t("label",null,"Email",-1),Me={class:"col-12 mt-sm-0 mb-3"},Ue=t("label",null,"Role",-1),Ve=["value"],Re={class:"col-12 mt-sm-0"},Se=t("label",null,"Password",-1),Ne={class:"col-12 mt-sm-0"},$e=t("label",null,"Confirm Password",-1),ke={class:"button-row d-flex mt-4"},ze={__name:"[id]",async setup(Ae){let _,g;const{$isDemo:L,$demoMessage:q}=z(),R=O(),{params:{id:p}}=K(),i=se(),w=te();Q(()=>{B("choices-currency")});const B=a=>{const s=document.getElementById(a);if(s)return new ie(s,{searchEnabled:!1})};w.allRolesList||([_,g]=S(()=>w.getAllRolesList()),await _,g());const n=N(""),y=N(null),o=$({name:"",email:"",role:w.allRolesList[0].id,password:"",passwordConfirm:""}),l=$([]),F=()=>{n.value=c},I=async()=>{const a=y.value.files;if(!a.length)return;const s=new FileReader;s.readAsDataURL(a[0]),s.onload=()=>{n.value=s.result}},T=async()=>{await i.getUser(p),o.name=i.selectedUser.name,o.email=i.selectedUser.email,o.role=i.selectedUser.roles[0].id,n.value=i.selectedUser.profile_image};[_,g]=S(()=>T()),await _,g();const D=G(()=>({name:{required:u.withMessage("The name field is required",V)},email:{required:u.withMessage("The email field is required",V),email:u.withMessage("Invalid email format",re)},password:{required:u.withMessage("The password field is required",V),minLength:u.withMessage("The password must be at least 8 characters",ae(8))},passwordConfirm:{sameAs:u.withMessage("Passwords don't match",le(o.password))}})),x=oe(D,o),J=async()=>{if(l.value=[],x.value.$validate(),x.value.$error||n.value===c){const a=JSON.parse(JSON.stringify(x.value.$errors));l.value=[...a]}else try{const a=new ne;let s="";n.value!==c&&(s=await i.uploadProfileImage(y,p));const f=a.serialize({stuff:{type:"users",id:p,name:o.name,email:o.email,profile_image:s,password:o.password,password_confirmation:o.passwordConfirm,roles:[{type:"roles",id:o.role}],relationshipNames:["roles"]}}),m=await i.updateUser(p,f);if(m.error.value){const r=m.error.value.data.errors[0].detail;throw new Error(r)}else A("success","User updated successfuly"),R.push({path:"/examples/user-management/list-users"})}catch(a){A("error",a.message)}};return(a,s)=>{const f=P,m=j;return h(),C("div",me,[t("div",de,[ue,t("button",{onClick:s[0]||(s[0]=M(r=>e(R).push({path:"/examples/user-management/list-users"}),["prevent"])),type:"button",class:"btn base-button btn-icon btn-fab btn-primary btn-sm"},pe)]),t("div",fe,[t("form",{role:"form",onSubmit:s[8]||(s[8]=M(r=>e(L)(e(p))?e(q)("users"):J(),["prevent"]))},[t("div",_e,[t("img",{src:e(n)?e(n):e(c),class:"rounded d-flex justify-content-center argon-image",width:"200",height:"200"},null,8,ge),t("div",we,[e(n)!==e(c)?(h(),H(f,{key:0,type:"button",onClick:s[1]||(s[1]=M(r=>F(),["prevent"])),class:"btn base-button btn btn-sm btn-danger btn-button mx-2"},{default:U(()=>[he]),_:1})):W("",!0),d(f,{type:"button",class:"btn base-button btn btn-sm btn-primary btn-button"},{default:U(()=>[t("label",be,k(e(n)!==e(c)?"Change":"Select image"),1),t("input",{ref_key:"file",ref:y,id:"imageInput",accept:"image/*",type:"file",style:{display:"none"},onChange:s[2]||(s[2]=r=>I())},null,544)]),_:1})])]),t("div",ve,[ye,d(m,{id:"name",name:"name",class:"multisteps-form__input",type:"text",placeholder:"Name",modelValue:e(o).name,"onUpdate:modelValue":s[3]||(s[3]=r=>e(o).name=r),error:e(b)("name",e(l)),errorMessage:e(v)("name",e(l))},null,8,["modelValue","error","errorMessage"])]),t("div",xe,[Ce,d(m,{id:"email",name:"email",class:"multisteps-form__input",type:"email",placeholder:"Email",modelValue:e(o).email,"onUpdate:modelValue":s[4]||(s[4]=r=>e(o).email=r),error:e(b)("email",e(l)),errorMessage:e(v)("email",e(l))},null,8,["modelValue","error","errorMessage"])]),t("div",Me,[Ue,X(t("select",{id:"choices-currency",class:"form-control",name:"choices-sizes","onUpdate:modelValue":s[5]||(s[5]=r=>e(o).role=r)},[(h(!0),C(Z,null,ee(e(w).rolesList,r=>(h(),C("option",{value:r.id},k(r.name),9,Ve))),256))],512),[[Y,e(o).role]])]),t("div",Re,[Se,d(m,{id:"password",name:"password",class:"multisteps-form__input",type:"password",placeholder:"******",modelValue:e(o).password,"onUpdate:modelValue":s[6]||(s[6]=r=>e(o).password=r),error:e(b)("password",e(l)),errorMessage:e(v)("password",e(l))},null,8,["modelValue","error","errorMessage"])]),t("div",Ne,[$e,d(m,{id:"passwordConfirm",name:"passwordConfirm",class:"multisteps-form__input",type:"password",placeholder:"******",modelValue:e(o).passwordConfirm,"onUpdate:modelValue":s[7]||(s[7]=r=>e(o).passwordConfirm=r),error:e(b)("passwordConfirm",e(l)),errorMessage:e(v)("passwordConfirm",e(l))},null,8,["modelValue","error","errorMessage"])]),t("div",ke,[d(f,{type:"submit",color:"primary",variant:"gradient",class:"ms-auto mb-0"},{default:U(()=>[E(" Submit ")]),_:1})])],32)])])}}};export{ze as default};
