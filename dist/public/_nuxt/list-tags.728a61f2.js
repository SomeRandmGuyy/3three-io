import $ from"./ArgonInput.8d0576a6.js";import{P as V,K as w,R as A,Q as D,y as R,O as E,o as m,b as p,e,T as F,i as _,l as P,u as r,Y as j,F as I,k as O,t as g,a5 as U,U as T,j as Q,f as S}from"./entry.6e39450e.js";import{u as Y}from"./index.aad0ddd6.js";import{D as q}from"./datatable.817348b2.js";import{_ as H,h as N}from"./lodash.623e3e94.js";import{u as K}from"./TagStore.0779537d.js";import{u as W}from"./AuthStore.cdc72645.js";import G from"./BasePagination.81d12301.js";import"./tslib.es6.4057be70.js";const J={class:"card shadow-lg mx-4 p-3 mt-4"},X={class:"d-flex justify-content-between px-4 pt-3"},Z=e("h5",{class:"font-weight-bolder mb-0"},"Tags List",-1),ee=e("span",{class:"btn-inner--text"},"Add Tag",-1),te=[ee],ae={class:"mt-4"},se={class:"table-responsive"},oe={class:"dataTable-search search-block"},ne={id:"tag-table",class:"table table-flush"},re={class:"thead-light"},le=e("th",null,"NAME",-1),ie=e("th",{"data-sortable":"false"},"COLOR",-1),ce=e("th",null,"CREATED AT",-1),de={key:0,"data-sortable":"false"},ge={class:"table-body"},ue={class:"text-sm font-weight-normal"},me={class:"text-sm font-weight-normal"},pe={class:"text-sm font-weight-normal"},fe={key:0,class:"text-sm font-weight-normal"},he={class:"d-flex align-items-center ms-auto"},be={class:"cursor-pointer edit"},_e={class:"mx-3 cursor-pointer delete"},ve={class:"d-flex justify-content-center justify-content-sm-between flex-wrap"},ye={class:"ms-3"},xe=null,Be={__name:"list-tags",async setup(we){let v,y;const k=V(),h=W(),l=K();let n;const c=w(""),u=w(""),d=H.debounce(async function(a){await l.getTagsList({filter:a.filter?a.filter:"",sort:a.sort?a.sort:"",pageNumber:a.pageNumber,pageSize:a.pageSize}),t.from=l.pageMeta.from,t.to=l.pageMeta.to,t.total=l.pageMeta.total,t.currentPage=l.pageMeta.currentPage,M()},300),t=A({currentPage:1,perPage:5,total:null,from:null,to:null});h.currentUser||([v,y]=D(()=>h.getProfile()),await v,y());const L=async a=>{t.currentPage=a,await d({pageNumber:t.currentPage,pageSize:t.perPage,sort:u.value,filter:c.value})},C=async()=>{document.getElementById("tag-table")&&(n=new q("#tag-table",{fixedHeight:!0,searchable:!1,perPage:5}),document.querySelector(".dataTable-bottom").remove(),n.setMessage("Loading ..."),await d({pageNumber:t.currentPage,pageSize:t.perPage}),N(x,"/examples/tag-management/edit-tag/","tags"),n.on("datatable.sort",async function(a,s){n.setMessage("Loading ..."),a=n.labels[a].toLowerCase().replace(" ","_"),s=s=="asc"?"":"-",u.value=s+a,await d({pageNumber:t.currentPage,pageSize:t.perPage,sort:s+a,filter:c.value})}),n.on("datatable.perpage",async function(a){t.perPage=a,await d({pageNumber:1,pageSize:a,sort:u.value,filter:c.value})}))};R(()=>{C()}),E(c,async a=>{n.setMessage("Loading ..."),await d({pageNumber:t.currentPage,pageSize:t.perPage,sort:u.value,filter:a})});const b=()=>h.userRole!=="member",x=a=>{U.fire({title:"Delete this tag?",showCancelButton:!0,cancelButtonText:"No, keep it",confirmButtonText:"Yes, delete it!",customClass:{confirmButton:"btn bg-gradient-success",cancelButton:"btn bg-gradient-danger"},buttonsStyling:!1}).then(async({isConfirmed:s})=>{if(s)try{const i=await l.deleteTag(a);if(i.error.value){const o=i.error.value.data.errors[0].detail;T("error",o)}else T("success","Tag deleted successfuly"),await d({pageNumber:1,pageSize:t.perPage,sort:u.value,filter:c.value})}catch(i){Y("error",i.message,"$5gRziWFFrQ")}})},M=()=>{const a=[];l.tagsList&&l.tagsList.length>0?(n.data=[],l.tagsList.forEach(({id:s,name:i,color:o,created_at:f})=>{a.push([`<div class="text-sm font-weight-normal">${i}</div>`,`<div class="text-sm font-weight-normal"><span class="badge" style="background-color:${o}">${i}</span></div>`,`<div class="text-sm font-weight-normal">${f}</div>`,`<div class="text-sm font-weight-normal">
                        <div class="d-flex align-items-center ms-auto">
                            <div class="cursor-pointer edit">
                                <i class="fas fa-user-edit text-secondary edit-${s}"></i>
                            </div>
                            <div class="mx-3 cursor-pointer delete">
                                <i class="fas fa-trash text-secondary delete-${s}"></i>
                            </div>
                        </div>
                    </div>`])}),n.refresh(),n.insert({data:a}),N(x,"/examples/tag-management/edit-tag/","tags")):n.setMessage("No entries found")};return(a,s)=>{const i=$;return m(),p("div",J,[e("div",X,[Z,b()?(m(),p("button",{key:0,type:"button",class:"btn base-button btn-icon btn-fab btn-primary btn-sm",onClick:s[0]||(s[0]=F(o=>r(k).push({path:"/examples/tag-management/add-tag"}),["prevent"]))},te)):_("",!0)]),e("div",ae,[e("div",se,[e("div",oe,[P(i,{modelValue:r(c),"onUpdate:modelValue":s[1]||(s[1]=o=>j(c)?c.value=o:null),class:"dataTable-input search-input-table",placeholder:"Search...",type:"text"},null,8,["modelValue"])]),e("table",ne,[e("thead",re,[e("tr",null,[le,ie,ce,b()?(m(),p("th",de,"ACTIONS")):_("",!0)])]),e("tbody",ge,[(m(),p(I,null,O(xe,({id:o,name:f,color:z,created_at:B})=>e("tr",{key:o},[e("td",ue,g(f),1),e("td",me,[e("span",{class:"badge",style:Q({"background-color":z})},g(f),5)]),e("td",pe,g(B),1),b()?(m(),p("td",fe,[e("div",he,[e("div",be,[e("i",{class:S(`fas fa-user-edit text-secondary edit-${o}`)},null,2)]),e("div",_e,[e("i",{class:S(`fas fa-trash text-secondary delete-${o}`)},null,2)])])])):_("",!0)])),64))])]),e("div",ve,[e("div",ye,[e("p",null," Showing "+g(r(t).total?r(t)?.from:0)+" to "+g(r(t)?.to)+" of "+g(r(t).total)+" entries ",1)]),P(G,{modelValue:r(t).currentPage,"onUpdate:modelValue":s[2]||(s[2]=o=>r(t).currentPage=o),class:"pagination-success pagination-md me-3",value:r(t).currentPage,"per-page":r(t).perPage,total:r(t).total,onClick:s[3]||(s[3]=o=>L(o))},null,8,["modelValue","value","per-page","total"])])])])])}}};export{Be as default};
