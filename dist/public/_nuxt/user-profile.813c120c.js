import j from"./ArgonButton.a79d4a57.js";import z from"./ArgonInput.8d0576a6.js";import{J as K,Q as L,K as _,R as S,o as k,b as Q,e as s,u as e,t as $,c as Y,w as b,i as G,l as c,Y as y,T as A,h as C,U as g}from"./entry.6e39450e.js";import{J as H}from"./index.aad0ddd6.js";import{d as x}from"./default_avatar.3b6e3719.js";import{u as O}from"./AuthStore.cdc72645.js";import{u as W}from"./UserStore.24d0d5dd.js";import{i as U,g as V}from"./errorHandler.790c67ca.js";import"./tslib.es6.4057be70.js";const X={class:"py-4 container-fluid"},Z={class:"card shadow-lg mx-4 profile-card"},ee={class:"card-body p-3"},se={class:"row gx-4"},te={class:"col-auto"},oe={class:"avatar avatar-xl position-relative"},re=["src"],ae={class:"col-auto my-auto"},le={class:"h-100"},ne={class:"mb-1"},ie={class:"mb-0 text-sm font-weight-bold"},de={class:"card shadow-lg mx-4 p-3 mt-4"},ue=s("h5",{class:"font-weight-bolder mb-0"},"Edit Profile",-1),ce={class:"mt-4"},me={class:"d-flex flex-column max-content align-items-center mb-4 mx-4"},pe=["src"],_e={class:"mt-2 d-flex justify-content-center"},fe=s("span",null,[s("i",{class:"fa fa-times"}),C(" Remove ")],-1),ve={for:"imageInput",class:"mb-0"},he={class:"col-12 mt-sm-0"},ge=s("label",null,"Name",-1),we={class:"col-12 mt-sm-0"},be=s("label",null,"Email",-1),ye={class:"button-row d-flex mt-4"},xe={class:"card shadow-lg mx-4 p-3 mt-4"},Ue=s("h5",{class:"font-weight-bolder mb-0"},"Change Password",-1),Ve={class:"mt-4"},$e={class:"col-12 mt-sm-0"},Ce=s("label",null,"New Password",-1),Pe={class:"col-12 mt-sm-0"},Me=s("label",null,"Repeat New Password",-1),Ee={class:"button-row d-flex mt-4"},De={__name:"user-profile",async setup(Ne){let P,M;const T=W(),o=O(),{$isDemo:E,$demoMessage:N}=K();o.currentUser||([P,M]=L(()=>o.getProfile()),await P,M());const R=new H;let w=_(null);const m=_(o.currentUser.profile_image),f=_(o.currentUser.name),v=_(o.currentUser.email),d=_(""),h=_(""),u=o.currentUser.id,n=S([]),r=S([]),B=async()=>{const a=w.value.files;if(!a.length)return;const t=new FileReader;t.readAsDataURL(a[0]),t.onload=()=>{m.value=t.result}},I=()=>{m.value=x,w.value=null},F=async()=>{try{if(n.value=[],D(),!n.value.length){let a=o.currentUser.profile_image;m.value!==x&&(a=await T.uploadProfileImage(w,u));const t=R.serialize({stuff:{type:"users",id:u,name:f.value,email:v.value,profile_image:a}}),i=await o.updateProfile(u,t);if(i.error.value){const p=i.error.value.data.errors[0].detail;g("error",p)}else g("success","Profile updated successfully")}}catch(a){g("error",a.message)}},q=async()=>{try{if(r.value=[],J(),!r.value.length){const a=R.serialize({stuff:{type:"users",id:u,password:d,password_confirmation:h}}),{error:t}=await o.updateProfile(u,a);if(t.value){const i=t.value.data.errors[0].detail;throw new Error(i)}else g("success","Password updated successfully")}}catch(a){g("error",a.message)}},D=()=>{f.value||(n.value=[...n.value,{$property:"name",$message:"The name field is required."}]),v.value||(n.value=[...n.value,{$property:"email",$message:"The email field is required."}])},J=()=>{d.value||(r.value=[...r.value,{$property:"password",$message:"The password field is required."}]),d.value.length<8&&(r.value=[...r.value,{$property:"password",$message:"The password must be at least 8 characters."}]),d.value!==h.value&&(r.value=[...r.value,{$property:"passwordConfirm",$message:"Passwords don't match."}])};return(a,t)=>{const i=j,p=z;return k(),Q("div",X,[s("div",Z,[s("div",ee,[s("div",se,[s("div",te,[s("div",oe,[s("img",{src:e(o).currentUser.profile_image,alt:"profile_image",class:"shadow-sm w-100 border-radius-lg"},null,8,re)])]),s("div",ae,[s("div",le,[s("h5",ne,$(e(o).currentUser.name),1),s("p",ie,$(e(o).currentUser.email),1)])])])])]),s("div",null,[s("div",de,[ue,s("div",ce,[s("div",me,[s("img",{src:e(m),class:"rounded d-flex justify-content-center argon-image",width:"200",height:"200"},null,8,pe),s("div",_e,[e(m)!==e(x)?(k(),Y(i,{key:0,type:"button",onClick:t[0]||(t[0]=l=>I()),class:"btn base-button btn btn-sm btn-danger btn-button mx-2"},{default:b(()=>[fe]),_:1})):G("",!0),c(i,{type:"button",class:"btn base-button btn btn-sm btn-primary btn-button"},{default:b(()=>[s("label",ve,$(e(m)!==e(x)?"Change":"Select image"),1),s("input",{ref_key:"file",ref:w,id:"imageInput",accept:"image/*",type:"file",style:{display:"none"},onChange:t[1]||(t[1]=l=>B())},null,544)]),_:1})])]),s("div",he,[ge,c(p,{id:"user-name",class:"multisteps-form__input",type:"text",placeholder:"Name",modelValue:e(f),"onUpdate:modelValue":t[2]||(t[2]=l=>y(f)?f.value=l:null),error:e(U)("name",e(n)),errorMessage:e(V)("name",e(n))},null,8,["modelValue","error","errorMessage"])]),s("div",we,[be,c(p,{id:"user-email",class:"multisteps-form__input",type:"email",placeholder:"Email",modelValue:e(v),"onUpdate:modelValue":t[3]||(t[3]=l=>y(v)?v.value=l:null),error:e(U)("email",e(n)),errorMessage:e(V)("email",e(n))},null,8,["modelValue","error","errorMessage"])]),s("div",ye,[c(i,{type:"button",color:"primary",variant:"gradient",class:"ms-auto mb-0",onClick:t[4]||(t[4]=A(l=>e(E)(e(u))?e(N)("users"):F(),["prevent"]))},{default:b(()=>[C("Submit ")]),_:1})])])]),s("div",xe,[Ue,s("div",Ve,[s("div",$e,[Ce,c(p,{id:"new-password",class:"multisteps-form__input",type:"password",placeholder:"******",modelValue:e(d),"onUpdate:modelValue":t[5]||(t[5]=l=>y(d)?d.value=l:null),error:e(U)("password",e(r)),errorMessage:e(V)("password",e(r))},null,8,["modelValue","error","errorMessage"])]),s("div",Pe,[Me,c(p,{id:"repeat-password",class:"multisteps-form__input",type:"password",placeholder:"******",modelValue:e(h),"onUpdate:modelValue":t[6]||(t[6]=l=>y(h)?h.value=l:null),error:e(U)("passwordConfirm",e(r)),errorMessage:e(V)("passwordConfirm",e(r))},null,8,["modelValue","error","errorMessage"])]),s("div",Ee,[c(i,{onClick:t[7]||(t[7]=A(l=>e(E)(e(u))?e(N)("users"):q(),["prevent"])),type:"button",color:"primary",variant:"gradient",class:"ms-auto mb-0"},{default:b(()=>[C("Submit ")]),_:1})])])])])])}}};export{De as default};
