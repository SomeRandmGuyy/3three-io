import k from"./ArgonInput.8d0576a6.js";import{P as z,K as x,R as E,Q as V,y as D,O as R,o as w,b as y,e,T as I,l as P,u as o,Y as O,F,k as j,t as d,a5 as q,U as S,f as T}from"./entry.6e39450e.js";import{u as H}from"./index.aad0ddd6.js";import{u as Y}from"./UserStore.24d0d5dd.js";import{u as G}from"./AuthStore.cdc72645.js";import{D as K}from"./datatable.817348b2.js";import{_ as Q,h as U}from"./lodash.623e3e94.js";import{d as L}from"./default_avatar.3b6e3719.js";import J from"./BasePagination.81d12301.js";import"./tslib.es6.4057be70.js";const W={class:"card shadow-lg mx-4 p-3 mt-4"},X={class:"d-flex justify-content-between px-4 pt-3"},Z=e("h5",{class:"font-weight-bolder mb-0"},"Users List",-1),ee=e("span",{class:"btn-inner--text"},"Add User",-1),te=[ee],se={class:"mt-4"},ae={class:"table-responsive"},re={class:"dataTable-search search-block"},oe={id:"user-table",class:"table table-flush"},ne=e("thead",{class:"thead-light"},[e("tr",null,[e("th",{"data-sortable":"false"},"AUTHOR"),e("th",null,"NAME"),e("th",null,"EMAIL"),e("th",null,"ROLE"),e("th",null,"CREATED AT"),e("th",{"data-sortable":"false"},"ACTIONS")])],-1),le={class:"text-sm text-black font-weight-normal"},ie=["src"],ce={class:"text-sm font-weight-normal"},ue={class:"text-sm font-weight-normal"},de={class:"text-sm font-weight-normal"},me={class:"text-sm font-weight-normal"},ge={class:"text-sm font-weight-normal"},pe={class:"d-flex align-items-center ms-auto"},fe={class:"cursor-pointer edit"},he={class:"mx-3 cursor-pointer delete"},be={class:"d-flex justify-content-center justify-content-sm-between flex-wrap"},_e={class:"ms-3"},ve=null,Be={__name:"list-users",async setup(xe){let b,_;const N=z(),g=G(),l=Y();let n;const i=x(""),u=x(""),m=Q.debounce(async function(s){await l.getUsersList({filter:s.filter?s.filter:"",sort:s.sort?s.sort:"",pageNumber:s.pageNumber,pageSize:s.pageSize}),t.from=l.pageMeta.from,t.to=l.pageMeta.to,t.total=l.pageMeta.total,t.currentPage=l.pageMeta.currentPage,B()},300),t=E({currentPage:1,perPage:5,total:null,from:null,to:null});g.currentUser||([b,_]=V(()=>g.getProfile()),await b,_());const M=async s=>{t.currentPage=s,await m({pageNumber:t.currentPage,pageSize:t.perPage,sort:u.value,filter:i.value})},A=async()=>{document.getElementById("user-table")&&(n=new K("#user-table",{fixedHeight:!0,searchable:!1,perPage:5}),document.querySelector(".dataTable-bottom").remove(),n.setMessage("Loading ..."),await m({pageNumber:t.currentPage,pageSize:t.perPage}),U(v,"/examples/user-management/edit-user/","users",g.currentUser.id),n.on("datatable.sort",async function(s,a){n.setMessage("Loading ..."),s=n.labels[s].toLowerCase().replace(" ","_"),a=a=="asc"?"":"-",s==="role"?u.value=a+"roles.name":u.value=a+s,await m({pageNumber:t.currentPage,pageSize:t.perPage,sort:u.value,filter:i.value})}),n.on("datatable.perpage",async function(s){t.perPage=s,await m({pageNumber:1,pageSize:s,sort:u.value,filter:i.value})}))};D(()=>{A()}),R(i,async s=>{n.setMessage("Loading ..."),await m({pageNumber:t.currentPage,pageSize:t.perPage,sort:u.value,filter:s})});const v=s=>{q.fire({title:"Delete this user?",showCancelButton:!0,cancelButtonText:"No, keep it",confirmButtonText:"Yes, delete it!",customClass:{confirmButton:"btn bg-gradient-success",cancelButton:"btn bg-gradient-danger"},buttonsStyling:!1}).then(async({isConfirmed:a})=>{if(a)try{const c=await l.deleteUser(s);if(c.error.value){const r=c.error.value.data.errors[0].detail;S("error",r)}else S("success","User deleted successfuly"),await m({pageNumber:1,pageSize:t.perPage,sort:u.value,filter:i.value})}catch(c){H("error",c.message,"$eF2GLsOTqn")}})},B=()=>{const s=[];l.usersList&&l.usersList.length>0?(n.data=[],l.usersList.forEach(({id:a,name:c,email:r,profile_image:p,roles:h,created_at:f})=>{s.push([`<div class="text-sm font-weight-normal">
                        <img src="${p||L}" class="avatar rounded-circle width-auto" alt="avatar" />
                    </div>`,`<div class="text-sm font-weight-normal">${c}</div>`,`<div class="text-sm font-weight-normal">${r}</div>`,`<div class="text-sm font-weight-normal">${h[0].name}</div>`,`<div class="text-sm font-weight-normal">${f}</div>`,`<div class="text-sm font-weight-normal">
                        <div class="d-flex align-items-center ms-auto">
                            <div class="cursor-pointer edit">
                                <i class="fas fa-user-edit text-secondary edit-${a}"></i>
                            </div>
                            <div class="mx-3 cursor-pointer delete">
                                <i class="fas fa-trash text-secondary delete-${a}"></i>
                            </div>
                        </div>
                    </div>`])}),n.refresh(),n.insert({data:s}),U(v,"/examples/user-management/edit-user/","users",g.currentUser.id)):n.setMessage("No entries found")};return(s,a)=>{const c=k;return w(),y("div",W,[e("div",X,[Z,e("button",{type:"button",class:"btn base-button btn-icon btn-fab btn-primary btn-sm",onClick:a[0]||(a[0]=I(r=>o(N).push({path:"/examples/user-management/add-user"}),["prevent"]))},te)]),e("div",se,[e("div",ae,[e("div",re,[P(c,{modelValue:o(i),"onUpdate:modelValue":a[1]||(a[1]=r=>O(i)?i.value=r:null),class:"dataTable-input search-input-table",placeholder:"Search...",type:"text"},null,8,["modelValue"])]),e("table",oe,[ne,e("tbody",null,[(w(),y(F,null,j(ve,({id:r,name:p,email:h,profile_image:f,roles:$,created_at:C})=>e("tr",{key:r},[e("td",le,[e("img",{src:f||o(L),class:"avatar rounded-circle width-auto",alt:"avatar"},null,8,ie)]),e("td",ce,d(p),1),e("td",ue,d(h),1),e("td",de,d($[0].name),1),e("td",me,d(C),1),e("td",ge,[e("div",pe,[e("div",fe,[e("i",{class:T(`fas fa-user-edit text-secondary edit-${r}`)},null,2)]),e("div",he,[e("i",{class:T(`fas fa-trash text-secondary delete-${r}`)},null,2)])])])])),64))])]),e("div",be,[e("div",_e,[e("p",null," Showing "+d(o(t).total?o(t)?.from:0)+" to "+d(o(t)?.to)+" of "+d(o(t).total)+" entries ",1)]),P(J,{modelValue:o(t).currentPage,"onUpdate:modelValue":a[2]||(a[2]=r=>o(t).currentPage=r),class:"pagination-success pagination-md me-3",value:o(t).currentPage,"per-page":o(t).perPage,total:o(t).total,onClick:a[3]||(a[3]=r=>M(r))},null,8,["modelValue","value","per-page","total"])])])])])}}};export{Be as default};
